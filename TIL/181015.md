# kubelet에 GPU resource 사용하도록 하기(NVIDIA GPU 기준)
* `--feature-gates`에서 `Accelerator`항목은 Kubernetes v1.10.x 이후 deprecated됨.
* `Accelerator` 대신 `DevicePlugins`를 추가.
* `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf`에 다음 항목 추가
    * Environment의 KUBELET_KUBECONFIG_ARGS의 맨 끝에 `--feature-gates=\"DevicePlugins=true\"`
* 저장 후
    * `sudo systemctl daemon-reload`와 `sudo systemctl restart kubelet` 

# kubeadm으로 만든 master node `Not Ready`상태 해결하기
* Network overlay 문제로 보임(CNI 문제)
* 다음 추가
    * `kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml`
    * `kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/k8s-manifests/kube-flannel-rbac.yml`

# Local에 master와 slave 같이 돌리기
* kubernetes에서는 모든 작업은 slave(node)에서 이루어지는데, kubelet과 kubeadm 만 세팅해서는 local machine에 slave node를 만들 수 없다.
* Local machine에서 돌리기 위한 방법 중 하나로 minikube를 선택했다.
* minikube는 vm을 이용해 node를 생성한다.
    * 이 node에서 GPU를 사용하려면 vm을 VirtualBox가 아닌 kvm2를 설치해야한다.
    * https://github.com/kubernetes/minikube/blob/master/docs/gpu.md
    * GRUB에서 `GRUB_CMDLINE_LINUX_DEFAULT`에 iommu사용을 추가해야한다. (`etc/default/grub`)
        * Intel의 경우 `intel_iommu=on`
        * AMD의 경우 `amd_iommu=on`
        * 수정 후 `update-grub`과 `reboot`실행
        * 또한 각각의 CPU Architecture에서 Intel: VT-D, AMD: AMD-VI 지원해야함
